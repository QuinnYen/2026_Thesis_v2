# 跨領域情感分析系統架構圖

## 整體系統架構

```
┌─────────────────────────────────────────────────────────────────┐
│                      主控制器 (Main Controller)                  │
│                  實驗配置管理、流程協調、結果彙整                  │
└─────────────────────────────────────────────────────────────────┘
                                    │
        ┌───────────────┬───────────┴───────────┬───────────────┐
        │               │                       │               │
        ▼               ▼                       ▼               ▼
┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ 數據處理模組 │ │ 模型訓練模組 │ │ 評估分析模組 │ │ 可視化模組   │
│ Data Module │ │Model Module │ │Eval Module  │ │Visual Module│
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘
```

## 一、數據處理模組 (Data Processing Module)

```
數據處理模組
├── 數據載入器 (Data Loader)
│   ├── SemEval-2014 載入器
│   ├── SemEval-2016 載入器
│   └── 自定義數據格式轉換器
│
├── 預處理器 (Preprocessor)
│   ├── 文本清理 (去除特殊字符、標準化)
│   ├── 分詞與詞性標註
│   ├── 面向術語提取與標註
│   └── 數據集分割 (訓練/驗證/測試)
│
├── 特徵提取器 (Feature Extractor)
│   ├── BERT 嵌入向量生成器
│   ├── LDA 主題模型建構器
│   ├── 領域特定詞彙表建構器
│   └── 統計特徵計算器
│
└── 跨領域對齊器 (Cross-domain Aligner)
    ├── 五個抽象面向定義器
    ├── 面向術語對應表建構器
    └── 語義相似度計算器
```

## 二、模型訓練模組 (Model Training Module)

```
模型訓練模組
├── 注意力機制庫 (Attention Mechanisms)
│   ├── 相似度注意力 (Similarity Attention)
│   ├── 關鍵詞導向注意力 (Keyword-guided Attention)
│   ├── 自注意力 (Self Attention)
│   ├── 多頭注意力 (Multi-head Attention)
│   └── 注意力融合器 (Attention Fusion)
│
├── 模型架構 (Model Architecture)
│   ├── BERT 編碼器
│   ├── 注意力層組合器
│   ├── 特徵融合層
│   └── 分類器 (面向級情感分類)
│
├── 訓練管理器 (Training Manager)
│   ├── 損失函數定義
│   ├── 優化器配置
│   ├── 學習率調度器
│   └── 早停機制
│
└── 模型快取系統 (Model Cache)
    ├── 預訓練模型管理
    ├── 中間結果保存
    └── 檢查點恢復機制
```

## 三、評估分析模組 (Evaluation Module)

```
評估分析模組
├── 標準評估器 (Standard Evaluator)
│   ├── 準確率計算器
│   ├── F1 分數計算器
│   ├── 精確率與召回率
│   └── 混淆矩陣生成器
│
├── 跨領域對齊評估器 (Cross-domain Alignment Evaluator) 【創新部分】
│   ├── 內聚性指標計算器
│   │   └── 同一抽象面向內的語義一致性測量
│   ├── 區分性指標計算器
│   │   └── 不同抽象面向間的差異性測量
│   ├── 穩定性指標計算器
│   │   └── 跨領域預測一致性測量
│   └── 綜合對齊分數計算器
│       └── 加權組合評估分數
│
├── 統計分析器 (Statistical Analyzer)
│   ├── 顯著性檢驗
│   ├── 效果量計算
│   └── 置信區間估計
│
└── 錯誤分析器 (Error Analyzer)
    ├── 困難樣本識別器
    ├── 錯誤模式分類器
    └── 注意力權重分析器
```

## 四、可視化模組 (Visualization Module)

```
可視化模組
├── 結果可視化器 (Result Visualizer)
│   ├── 跨領域準確率比較表
│   ├── 注意力機制效能對比圖
│   ├── 面向對齊分數熱力圖
│   └── 錯誤率趨勢圖
│
├── 注意力可視化器 (Attention Visualizer)
│   ├── 注意力權重熱力圖
│   ├── 注意力頭比較圖
│   └── 文本-注意力對應圖
│
├── 語義空間可視化器 (Semantic Space Visualizer)
│   ├── t-SNE 降維圖生成器
│   ├── 面向聚類可視化
│   └── 跨領域語義分布圖
│
└── 實驗報告生成器 (Report Generator)
    ├── 自動化表格生成
    ├── 圖表組合器
    └── PDF/HTML 報告輸出
```

## 五、配置與工具模組 (Configuration & Utils)

```
配置與工具模組
├── 實驗配置管理器 (Config Manager)
│   ├── 超參數配置文件
│   ├── 數據集路徑配置
│   ├── 模型參數配置
│   └── 評估指標配置
│
├── 日誌系統 (Logging System)
│   ├── 實驗進度追蹤
│   ├── 錯誤日誌記錄
│   ├── 性能監控
│   └── 結果版本控制
│
├── 工具函數庫 (Utility Functions)
│   ├── 文件輸入輸出工具
│   ├── 數學計算工具
│   ├── 文本處理工具
│   └── 隨機種子管理
│
└── 實驗管理器 (Experiment Manager)
    ├── 批量實驗執行器
    ├── 結果對比分析器
    ├── 超參數搜索器
    └── 實驗重現驗證器
```

## 六、數據流程圖

```
原始數據 → 數據載入 → 預處理 → 特徵提取 → 跨領域對齊
    ↓                                               ↓
模型訓練 ← 注意力機制選擇 ← 架構配置 ← 特徵融合 ← 面向對應
    ↓                                               ↓
模型評估 → 標準指標計算 → 跨領域對齊評估 → 統計分析 → 可視化
    ↓                                               ↓
結果分析 → 錯誤分析 → 注意力權重分析 → 報告生成 → 論文撰寫
```

## 七、關鍵接口定義

### 7.1 數據接口
- **輸入**: SemEval 標準格式數據集
- **輸出**: 標準化的訓練/測試數據對象

### 7.2 模型接口
- **輸入**: 文本特徵向量 + 面向標註
- **輸出**: 情感分類結果 + 注意力權重

### 7.3 評估接口
- **輸入**: 預測結果 + 真實標籤
- **輸出**: 評估指標字典 + 詳細分析報告

### 7.4 可視化接口
- **輸入**: 實驗結果數據
- **輸出**: 圖表文件 + 交互式可視化

## 八、文件組織結構

```
project_root/
├── src/                    # 源代碼目錄
│   ├── data/              # 數據處理模組
│   ├── models/            # 模型定義
│   ├── attention/         # 注意力機制
│   ├── evaluation/        # 評估模組
│   ├── visualization/     # 可視化
│   └── utils/             # 工具函數
├── data/                  # 數據存放目錄
│   ├── raw/               # 原始數據
│   ├── processed/         # 處理後數據
│   └── cache/             # 快取文件
├── experiments/           # 實驗配置和結果
│   ├── configs/           # 配置文件
│   ├── logs/              # 日誌文件
│   └── results/           # 實驗結果
├── outputs/               # 輸出目錄
│   ├── models/            # 訓練好的模型
│   ├── figures/           # 生成的圖表
│   └── reports/           # 實驗報告
└── tests/                 # 測試代碼
```